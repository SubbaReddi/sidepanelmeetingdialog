#pragma checksum "D:\V2\Microsoft-Teams-Samples-main\samples\meetings-sidepanel\csharp\Side Panel\Views\Home\sidePanel.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "8932c4b3efd66825f7f582fdb6ae02a202683142"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(SignalRTest.Pages.Home.Views_Home_sidePanel), @"mvc.1.0.view", @"/Views/Home/sidePanel.cshtml")]
namespace SignalRTest.Pages.Home
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#nullable restore
#line 1 "D:\V2\Microsoft-Teams-Samples-main\samples\meetings-sidepanel\csharp\Side Panel\Views\_ViewImports.cshtml"
using SignalRTest;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"8932c4b3efd66825f7f582fdb6ae02a202683142", @"/Views/Home/sidePanel.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"e7c074cfb368df291582a9cfc43e4c6809e19006", @"/Views/_ViewImports.cshtml")]
    #nullable restore
    public class Views_Home_sidePanel : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<List<SidePanel.Models.TaskInfo>>
    #nullable disable
    {
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
            WriteLiteral("\n");
#nullable restore
#line 3 "D:\V2\Microsoft-Teams-Samples-main\samples\meetings-sidepanel\csharp\Side Panel\Views\Home\sidePanel.cshtml"
  
    Layout = "~/Views/Shared/_Layout.cshtml";

#line default
#line hidden
#nullable disable
            WriteLiteral(@"
    <div class=""agendaTitle"">
        Agenda for today
    </div>
    <div id=""meetingOrganizer"">
        <div id=""agendaButtonDiv"">
            <button id=""agendaButton"" onclick=""showAgendaInput()"">Add New Agenda Item</button>
        </div>
        <div id=""agendaInputDiv"" style=""display:none"">
            <input type=""text"" id=""agendaInput""><br>
            <button id=""addAgendaButton"" onclick=""closeAgendaInput()"">Add</button>
        </div>
    </div>
    <div id=""list"">
        <ol type=""1"" id=""agendaList"">

            ");
#nullable restore
#line (22,14)-(22,69) 6 "D:\V2\Microsoft-Teams-Samples-main\samples\meetings-sidepanel\csharp\Side Panel\Views\Home\sidePanel.cshtml"
Write(await Html.PartialAsync("SidePanelParticalView", Model));

#line default
#line hidden
#nullable disable
            WriteLiteral(@"

        </ol>
    </div>
    <button id=""publishAgendaButton"">Publish Agenda</button>

    <script type=""text/javascript"">

        //Default Action On View Render
        microsoftTeams.initialize();
        var userId = """";
        window.onload = function () {
            microsoftTeams.getContext(function (context) {
                userId = context.userObjectId;
                var meetingId = context.meetingId;
                var tenantId = context.tid;
                alert(context.chatId);
                $.ajax({
                    type: 'GET',
                    url: '/Home/IsOrganizer',
                    dataType: 'json',
                    data: { userId: userId, meetingId: meetingId, tenantId: context.chatId },
                    success: function (response) {
                        console.log(response);
                        RoleFunction(response);
                    },
                    error: function (xhr, textStatus, errorThrown) {
                        console.log(""textSta");
            WriteLiteral(@"tus: "" + textStatus + "", errorThrown:"" + response);
                    },
                });
            })
        }

        //Enabling Organizer Tools
        function RoleFunction(response) {
            if (response === true) {
                document.getElementById(""meetingOrganizer"").style.display = ""block"";
                document.getElementById(""publishAgendaButton"").style.display = ""block"";
            }
            else {
                document.getElementById(""meetingOrganizer"").style.display = ""none"";
                document.getElementById(""publishAgendaButton"").style.display = ""none"";
            }
        }

        //Toggle Agenda Add Button/Agenda Text Input
        function showAgendaInput() {
            document.getElementById(""agendaInputDiv"").style.display = ""block"";
            document.getElementById(""agendaButtonDiv"").style.display = ""none"";
            document.getElementById(""agendaInput"").focus();
            event.preventDefault();
        }

        //Publish the Agenda to ");
            WriteLiteral(@"the Chat Conversation
        $(""#publishAgendaButton"").on('click', function (e) {
            $.ajax({
                type: 'GET',
                url: '/Home/SendAgenda',
                dataType: 'json',
                success: function (response) {
                    console.log(response);
                    console.log(""Agenda Published to Chat"");
                },
                error: function (xhr, textStatus, errorThrown) {
                    console.log(""textStatus: "" + textStatus + "", errorThrown:"" + response);
                },
            });
            event.preventDefault();
        })

        //On Click of Add Button Add the Agenda Point to the List
        $(""#addAgendaButton"").on('click', function (e) {
            document.getElementById(""agendaInputDiv"").style.display = ""none"";
            document.getElementById(""agendaButtonDiv"").style.display = ""block"";
            var newAgendaItem = $(""#agendaInput"").val();
            if (newAgendaItem != """") {
                e.preventDefa");
            WriteLiteral(@"ult();
                let taskInfo = {
                    title: newAgendaItem
                };
                $.ajax({
                    type: 'GET',
                    url: '/Home/AddNewAgendaPoint',
                    dataType: 'json',
                    data: taskInfo,
                    success: function (response) {
                        console.log(response);
                    },
                    error: function (xhr, textStatus, errorThrown) {
                        console.log(""textStatus: "" + textStatus + "", errorThrown:"" + errorThrown);
                    },
                });
                document.getElementById(""agendaInput"").value = '';
            }
            event.preventDefault();
        })
    </script>
");
        }
        #pragma warning restore 1998
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; } = default!;
        #nullable disable
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; } = default!;
        #nullable disable
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; } = default!;
        #nullable disable
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; } = default!;
        #nullable disable
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<List<SidePanel.Models.TaskInfo>> Html { get; private set; } = default!;
        #nullable disable
    }
}
#pragma warning restore 1591
